# 要件定義書：Notion注文情報からの請求書PDF・メール自動生成ツール

## 1. 概要

本プロジェクトは、Notionデータベースで管理されている注文情報を基に、請求書PDFと送付用メールを自動生成するデスクトップアプリケーションを開発することを目的とする。手作業による請求書作成とメール送付のプロセスを自動化し、業務効率を向上させる。

## 2. 機能要件

### 2.1. GUI機能
ユーザーが直感的に操作できるGUIを提供する。

- **設定画面**:
    - Notion APIキー、データベースID、およびメール送信用アカウント情報（SMTPサーバー、ポート、ユーザー名、パスワード）を入力・保存する機能。
- **データ表示画面**:
    - Notionから取得した注文情報を一覧で表示する。
    - ユーザーは表示されたリストから、請求書を作成したい注文を選択できる。
- **操作ボタン**:
    - 「データ取得」ボタン：Notionから最新の注文情報を取得・更新する。
    - 「請求書PDF生成」ボタン：選択した注文情報に基づいて請求書PDFを生成する。
    - 「メール作成・送信」ボタン：生成したPDFを添付し、顧客へのメールを作成して送信する。

### 2.2. Notion連携機能

- 指定されたNotionデータベースから注文情報を取得する。
- APIを通じて、特定の条件（例：ステータスが「対応済み」でないなど）でデータをフィルタリングする機能を持つ。

### 2.3. PDF生成機能

- 取得した注文情報（顧客名、商品名、金額、日付など）を基に、規定のフォーマットで請求書PDFを生成する。
- 生成されるPDFは、日本語の文字化けが発生しないようにする。
- 生成したPDFは、指定されたローカルフォルダに保存される。

### 2.4. メール送付機能

- 設定されたSMTPアカウント情報を使用し、メールを送信する。
- 宛先（To）、件名（Subject）、本文（Body）は、注文情報に基づいて自動的に設定される。
- 生成された請求書PDFをメールに自動で添付する。

## 3. 非機能要件

### 3.1. 技術スタック・使用ライブラリ

- **プログラミング言語**: Python 3
- **GUIフレームワーク**: Tkinter
- **主要ライブラリ**:
    - `requests`: Notion APIとの通信
    - `reportlab`: PDFの生成
    - `python-dotenv`: APIキーやパスワードなどの設定管理
    - その他 `requirements.txt` に記載のライブラリ

### 3.2. 設定管理

- Notion APIキーやメールのパスワードなどの機密情報は、`.env`ファイルに記述し、コード本体とは分離して管理する。

### 3.3. 実行環境

- Windows, macOS, Linuxで動作するクロスプラットフォームのデスクトップアプリケーションとする。

## 4. ファイル構成

```
/
├── .gitignore
├── app_gui.py         # GUIの構築とイベント処理
├── config.py          # 設定情報（APIキー等）の読み込み
├── email_service.py   # メール作成・送信処理
├── main.py            # アプリケーションのエントリーポイント
├── notion_api.py      # Notion APIとの連携処理
├── pdf_generator.py   # 請求書PDFの生成処理
├── requirements.txt   # 依存ライブラリリスト
└── 要件定義書.md      # このファイル
```
